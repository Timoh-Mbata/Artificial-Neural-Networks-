{
 "cells": [
  {
   "cell_type": "raw",
   "id": "7e4825c7-f594-4b3d-b44a-15e1d818ca10",
   "metadata": {},
   "source": [
    "# Take this dataset for bank customer churn prediction \n",
    "# 1) Build a deep learning model to predict churn rate at bank. \n",
    "# 2) Once model is built, print classification report and analyze precision, recall and f1-score "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "7fef390c-f1e0-4348-943e-26b385a3a725",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt \n",
    "%matplotlib inline "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "3eb79f35-360c-4868-bec7-651115a027b5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customerID</th>\n",
       "      <th>gender</th>\n",
       "      <th>SeniorCitizen</th>\n",
       "      <th>Partner</th>\n",
       "      <th>Dependents</th>\n",
       "      <th>tenure</th>\n",
       "      <th>PhoneService</th>\n",
       "      <th>MultipleLines</th>\n",
       "      <th>InternetService</th>\n",
       "      <th>OnlineSecurity</th>\n",
       "      <th>...</th>\n",
       "      <th>DeviceProtection</th>\n",
       "      <th>TechSupport</th>\n",
       "      <th>StreamingTV</th>\n",
       "      <th>StreamingMovies</th>\n",
       "      <th>Contract</th>\n",
       "      <th>PaperlessBilling</th>\n",
       "      <th>PaymentMethod</th>\n",
       "      <th>MonthlyCharges</th>\n",
       "      <th>TotalCharges</th>\n",
       "      <th>Churn</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6894</th>\n",
       "      <td>1400-MMYXY</td>\n",
       "      <td>Male</td>\n",
       "      <td>1</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>3</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Fiber optic</td>\n",
       "      <td>No</td>\n",
       "      <td>...</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Month-to-month</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Electronic check</td>\n",
       "      <td>105.9</td>\n",
       "      <td>334.65</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4430</th>\n",
       "      <td>5061-PBXFW</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>32</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>DSL</td>\n",
       "      <td>Yes</td>\n",
       "      <td>...</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "      <td>Month-to-month</td>\n",
       "      <td>No</td>\n",
       "      <td>Bank transfer (automatic)</td>\n",
       "      <td>61.4</td>\n",
       "      <td>1864.65</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2857</th>\n",
       "      <td>7771-CFQRQ</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "      <td>47</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>DSL</td>\n",
       "      <td>No</td>\n",
       "      <td>...</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Two year</td>\n",
       "      <td>No</td>\n",
       "      <td>Bank transfer (automatic)</td>\n",
       "      <td>63.8</td>\n",
       "      <td>3007.25</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      customerID  gender  SeniorCitizen Partner Dependents  tenure  \\\n",
       "6894  1400-MMYXY    Male              1     Yes         No       3   \n",
       "4430  5061-PBXFW  Female              0     Yes        Yes      32   \n",
       "2857  7771-CFQRQ  Female              0     Yes        Yes      47   \n",
       "\n",
       "     PhoneService MultipleLines InternetService OnlineSecurity  ...  \\\n",
       "6894          Yes           Yes     Fiber optic             No  ...   \n",
       "4430          Yes            No             DSL            Yes  ...   \n",
       "2857          Yes            No             DSL             No  ...   \n",
       "\n",
       "     DeviceProtection TechSupport StreamingTV StreamingMovies        Contract  \\\n",
       "6894              Yes          No         Yes             Yes  Month-to-month   \n",
       "4430               No         Yes          No              No  Month-to-month   \n",
       "2857               No         Yes          No             Yes        Two year   \n",
       "\n",
       "     PaperlessBilling              PaymentMethod MonthlyCharges  TotalCharges  \\\n",
       "6894              Yes           Electronic check          105.9        334.65   \n",
       "4430               No  Bank transfer (automatic)           61.4       1864.65   \n",
       "2857               No  Bank transfer (automatic)           63.8       3007.25   \n",
       "\n",
       "     Churn  \n",
       "6894   Yes  \n",
       "4430    No  \n",
       "2857    No  \n",
       "\n",
       "[3 rows x 21 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = pd.read_csv(\"customer_churn.csv\")\n",
    "data.sample(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "b38dd279-e9ed-448a-88f0-a21b64a72cdc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['customerID', 'gender', 'SeniorCitizen', 'Partner', 'Dependents',\n",
       "       'tenure', 'PhoneService', 'MultipleLines', 'InternetService',\n",
       "       'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport',\n",
       "       'StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling',\n",
       "       'PaymentMethod', 'MonthlyCharges', 'TotalCharges', 'Churn'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "62869f20-ec20-43f1-a448-22fd864b6412",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 7043 entries, 0 to 7042\n",
      "Data columns (total 21 columns):\n",
      " #   Column            Non-Null Count  Dtype  \n",
      "---  ------            --------------  -----  \n",
      " 0   customerID        7043 non-null   object \n",
      " 1   gender            7043 non-null   object \n",
      " 2   SeniorCitizen     7043 non-null   int64  \n",
      " 3   Partner           7043 non-null   object \n",
      " 4   Dependents        7043 non-null   object \n",
      " 5   tenure            7043 non-null   int64  \n",
      " 6   PhoneService      7043 non-null   object \n",
      " 7   MultipleLines     7043 non-null   object \n",
      " 8   InternetService   7043 non-null   object \n",
      " 9   OnlineSecurity    7043 non-null   object \n",
      " 10  OnlineBackup      7043 non-null   object \n",
      " 11  DeviceProtection  7043 non-null   object \n",
      " 12  TechSupport       7043 non-null   object \n",
      " 13  StreamingTV       7043 non-null   object \n",
      " 14  StreamingMovies   7043 non-null   object \n",
      " 15  Contract          7043 non-null   object \n",
      " 16  PaperlessBilling  7043 non-null   object \n",
      " 17  PaymentMethod     7043 non-null   object \n",
      " 18  MonthlyCharges    7043 non-null   float64\n",
      " 19  TotalCharges      7043 non-null   object \n",
      " 20  Churn             7043 non-null   object \n",
      "dtypes: float64(1), int64(2), object(18)\n",
      "memory usage: 1.1+ MB\n"
     ]
    }
   ],
   "source": [
    "data.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "4e888c14-cb64-462b-83c7-39a1ec3b9079",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(7043, 21)"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "0b35e7cc-c744-4a45-8984-4fcfa130b7f6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "customerID          0\n",
       "gender              0\n",
       "SeniorCitizen       0\n",
       "Partner             0\n",
       "Dependents          0\n",
       "tenure              0\n",
       "PhoneService        0\n",
       "MultipleLines       0\n",
       "InternetService     0\n",
       "OnlineSecurity      0\n",
       "OnlineBackup        0\n",
       "DeviceProtection    0\n",
       "TechSupport         0\n",
       "StreamingTV         0\n",
       "StreamingMovies     0\n",
       "Contract            0\n",
       "PaperlessBilling    0\n",
       "PaymentMethod       0\n",
       "MonthlyCharges      0\n",
       "TotalCharges        0\n",
       "Churn               0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "181662a7-3cb3-4f87-ac5d-543dadab64bd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data[\"customerID\"].duplicated().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "f3a86198-d0af-4dee-88f1-91abdb888748",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['gender', 'SeniorCitizen', 'Partner', 'Dependents', 'tenure',\n",
       "       'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity',\n",
       "       'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV',\n",
       "       'StreamingMovies', 'Contract', 'PaperlessBilling', 'PaymentMethod',\n",
       "       'MonthlyCharges', 'TotalCharges', 'Churn'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data2=data.drop(columns=\"customerID\")\n",
    "data2.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "6dd1969b-89b9-4ef5-9817-332bfad33d8b",
   "metadata": {},
   "outputs": [],
   "source": [
    "import warnings \n",
    "warnings.filterwarnings(action=\"ignore\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "c36bd1c8-eaea-4980-8b15-5f01a8466ae3",
   "metadata": {},
   "outputs": [],
   "source": [
    "yes_no_columns = ['Partner','Dependents','PhoneService','MultipleLines','OnlineSecurity','OnlineBackup',\n",
    "                  'DeviceProtection','TechSupport','StreamingTV','StreamingMovies','PaperlessBilling','Churn']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "74aff4c6-d20e-4d3c-9660-5f04c93d1c21",
   "metadata": {},
   "outputs": [],
   "source": [
    "for col in yes_no_columns:\n",
    "    data2[col].str.strip().str.title"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "9ff9ec7d-4d21-4454-adf9-51b4e39ffaa5",
   "metadata": {},
   "outputs": [],
   "source": [
    "for col in yes_no_columns:\n",
    "    data2[col].replace({'Yes': 1, 'No internet service': 0, 'No': 0}, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "0427253c-3f1a-4024-b5ca-ffdeadd648b7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>SeniorCitizen</th>\n",
       "      <th>Partner</th>\n",
       "      <th>Dependents</th>\n",
       "      <th>tenure</th>\n",
       "      <th>PhoneService</th>\n",
       "      <th>MultipleLines</th>\n",
       "      <th>InternetService</th>\n",
       "      <th>OnlineSecurity</th>\n",
       "      <th>OnlineBackup</th>\n",
       "      <th>DeviceProtection</th>\n",
       "      <th>TechSupport</th>\n",
       "      <th>StreamingTV</th>\n",
       "      <th>StreamingMovies</th>\n",
       "      <th>Contract</th>\n",
       "      <th>PaperlessBilling</th>\n",
       "      <th>PaymentMethod</th>\n",
       "      <th>MonthlyCharges</th>\n",
       "      <th>TotalCharges</th>\n",
       "      <th>Churn</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>No phone service</td>\n",
       "      <td>DSL</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Month-to-month</td>\n",
       "      <td>1</td>\n",
       "      <td>Electronic check</td>\n",
       "      <td>29.85</td>\n",
       "      <td>29.85</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>34</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>DSL</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>One year</td>\n",
       "      <td>0</td>\n",
       "      <td>Mailed check</td>\n",
       "      <td>56.95</td>\n",
       "      <td>1889.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>DSL</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Month-to-month</td>\n",
       "      <td>1</td>\n",
       "      <td>Mailed check</td>\n",
       "      <td>53.85</td>\n",
       "      <td>108.15</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>45</td>\n",
       "      <td>0</td>\n",
       "      <td>No phone service</td>\n",
       "      <td>DSL</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>One year</td>\n",
       "      <td>0</td>\n",
       "      <td>Bank transfer (automatic)</td>\n",
       "      <td>42.30</td>\n",
       "      <td>1840.75</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>Fiber optic</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Month-to-month</td>\n",
       "      <td>1</td>\n",
       "      <td>Electronic check</td>\n",
       "      <td>70.70</td>\n",
       "      <td>151.65</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7038</th>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>24</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>DSL</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>One year</td>\n",
       "      <td>1</td>\n",
       "      <td>Mailed check</td>\n",
       "      <td>84.80</td>\n",
       "      <td>1990.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7039</th>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>72</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Fiber optic</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>One year</td>\n",
       "      <td>1</td>\n",
       "      <td>Credit card (automatic)</td>\n",
       "      <td>103.20</td>\n",
       "      <td>7362.9</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7040</th>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "      <td>No phone service</td>\n",
       "      <td>DSL</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Month-to-month</td>\n",
       "      <td>1</td>\n",
       "      <td>Electronic check</td>\n",
       "      <td>29.60</td>\n",
       "      <td>346.45</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7041</th>\n",
       "      <td>Male</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Fiber optic</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>Month-to-month</td>\n",
       "      <td>1</td>\n",
       "      <td>Mailed check</td>\n",
       "      <td>74.40</td>\n",
       "      <td>306.6</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7042</th>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>66</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>Fiber optic</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Two year</td>\n",
       "      <td>1</td>\n",
       "      <td>Bank transfer (automatic)</td>\n",
       "      <td>105.65</td>\n",
       "      <td>6844.5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>7043 rows × 20 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      gender  SeniorCitizen  Partner  Dependents  tenure  PhoneService  \\\n",
       "0     Female              0        1           0       1             0   \n",
       "1       Male              0        0           0      34             1   \n",
       "2       Male              0        0           0       2             1   \n",
       "3       Male              0        0           0      45             0   \n",
       "4     Female              0        0           0       2             1   \n",
       "...      ...            ...      ...         ...     ...           ...   \n",
       "7038    Male              0        1           1      24             1   \n",
       "7039  Female              0        1           1      72             1   \n",
       "7040  Female              0        1           1      11             0   \n",
       "7041    Male              1        1           0       4             1   \n",
       "7042    Male              0        0           0      66             1   \n",
       "\n",
       "         MultipleLines InternetService  OnlineSecurity  OnlineBackup  \\\n",
       "0     No phone service             DSL               0             1   \n",
       "1                    0             DSL               1             0   \n",
       "2                    0             DSL               1             1   \n",
       "3     No phone service             DSL               1             0   \n",
       "4                    0     Fiber optic               0             0   \n",
       "...                ...             ...             ...           ...   \n",
       "7038                 1             DSL               1             0   \n",
       "7039                 1     Fiber optic               0             1   \n",
       "7040  No phone service             DSL               1             0   \n",
       "7041                 1     Fiber optic               0             0   \n",
       "7042                 0     Fiber optic               1             0   \n",
       "\n",
       "      DeviceProtection  TechSupport  StreamingTV  StreamingMovies  \\\n",
       "0                    0            0            0                0   \n",
       "1                    1            0            0                0   \n",
       "2                    0            0            0                0   \n",
       "3                    1            1            0                0   \n",
       "4                    0            0            0                0   \n",
       "...                ...          ...          ...              ...   \n",
       "7038                 1            1            1                1   \n",
       "7039                 1            0            1                1   \n",
       "7040                 0            0            0                0   \n",
       "7041                 0            0            0                0   \n",
       "7042                 1            1            1                1   \n",
       "\n",
       "            Contract  PaperlessBilling              PaymentMethod  \\\n",
       "0     Month-to-month                 1           Electronic check   \n",
       "1           One year                 0               Mailed check   \n",
       "2     Month-to-month                 1               Mailed check   \n",
       "3           One year                 0  Bank transfer (automatic)   \n",
       "4     Month-to-month                 1           Electronic check   \n",
       "...              ...               ...                        ...   \n",
       "7038        One year                 1               Mailed check   \n",
       "7039        One year                 1    Credit card (automatic)   \n",
       "7040  Month-to-month                 1           Electronic check   \n",
       "7041  Month-to-month                 1               Mailed check   \n",
       "7042        Two year                 1  Bank transfer (automatic)   \n",
       "\n",
       "      MonthlyCharges TotalCharges  Churn  \n",
       "0              29.85        29.85      0  \n",
       "1              56.95       1889.5      0  \n",
       "2              53.85       108.15      1  \n",
       "3              42.30      1840.75      0  \n",
       "4              70.70       151.65      1  \n",
       "...              ...          ...    ...  \n",
       "7038           84.80       1990.5      0  \n",
       "7039          103.20       7362.9      0  \n",
       "7040           29.60       346.45      0  \n",
       "7041           74.40        306.6      1  \n",
       "7042          105.65       6844.5      0  \n",
       "\n",
       "[7043 rows x 20 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "d1198eda-52c0-47f5-a3d9-a8183f0725ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "data3=data2.copy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "31e831ac-a389-4888-ab8e-02792ca849fe",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['gender', 'SeniorCitizen', 'Partner', 'Dependents', 'tenure',\n",
       "       'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity',\n",
       "       'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV',\n",
       "       'StreamingMovies', 'Contract', 'PaperlessBilling', 'PaymentMethod',\n",
       "       'MonthlyCharges', 'TotalCharges', 'Churn'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data3.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "1f2b62c0-241e-472a-9a2f-ea986194ad81",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method Series.unique of 0       Female\n",
       "1         Male\n",
       "2         Male\n",
       "3         Male\n",
       "4       Female\n",
       "         ...  \n",
       "7038      Male\n",
       "7039    Female\n",
       "7040    Female\n",
       "7041      Male\n",
       "7042      Male\n",
       "Name: gender, Length: 7043, dtype: object>"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data3.gender.unique"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "95cffe5b-6623-458d-86d7-9aab26c8518c",
   "metadata": {},
   "outputs": [],
   "source": [
    "data3['gender']=data3['gender'].replace({'Male':1,'Female':0})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "e6249363-4dee-4a60-b5e5-7ef0bc3335e9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 7043 entries, 0 to 7042\n",
      "Data columns (total 20 columns):\n",
      " #   Column            Non-Null Count  Dtype  \n",
      "---  ------            --------------  -----  \n",
      " 0   gender            7043 non-null   int64  \n",
      " 1   SeniorCitizen     7043 non-null   int64  \n",
      " 2   Partner           7043 non-null   int64  \n",
      " 3   Dependents        7043 non-null   int64  \n",
      " 4   tenure            7043 non-null   int64  \n",
      " 5   PhoneService      7043 non-null   int64  \n",
      " 6   MultipleLines     7043 non-null   object \n",
      " 7   InternetService   7043 non-null   object \n",
      " 8   OnlineSecurity    7043 non-null   int64  \n",
      " 9   OnlineBackup      7043 non-null   int64  \n",
      " 10  DeviceProtection  7043 non-null   int64  \n",
      " 11  TechSupport       7043 non-null   int64  \n",
      " 12  StreamingTV       7043 non-null   int64  \n",
      " 13  StreamingMovies   7043 non-null   int64  \n",
      " 14  Contract          7043 non-null   object \n",
      " 15  PaperlessBilling  7043 non-null   int64  \n",
      " 16  PaymentMethod     7043 non-null   object \n",
      " 17  MonthlyCharges    7043 non-null   float64\n",
      " 18  TotalCharges      7043 non-null   object \n",
      " 19  Churn             7043 non-null   int64  \n",
      "dtypes: float64(1), int64(14), object(5)\n",
      "memory usage: 1.1+ MB\n"
     ]
    }
   ],
   "source": [
    "data3.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "2dafca30-2981-431d-939b-16078ea8a33d",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "gender                int64\n",
       "SeniorCitizen         int64\n",
       "Partner               int64\n",
       "Dependents            int64\n",
       "tenure                int64\n",
       "PhoneService          int64\n",
       "MultipleLines        object\n",
       "InternetService      object\n",
       "OnlineSecurity        int64\n",
       "OnlineBackup          int64\n",
       "DeviceProtection      int64\n",
       "TechSupport           int64\n",
       "StreamingTV           int64\n",
       "StreamingMovies       int64\n",
       "Contract             object\n",
       "PaperlessBilling      int64\n",
       "PaymentMethod        object\n",
       "MonthlyCharges      float64\n",
       "TotalCharges         object\n",
       "Churn                 int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data3.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "c3eaa9c1-c571-4bc9-982d-d0a8f6b33fd4",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Drop rows with NaN or empty strings in 'TotalCharges'\n",
    "data3 = data3[data3['TotalCharges'].str.strip() != '']\n",
    "data3 = data3.dropna(subset=['TotalCharges'])\n",
    "# Now apply the conversion\n",
    "data3['TotalCharges'] = data3['TotalCharges'].astype(float)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "7205b443-6ad7-4a58-b853-42f9f3c68279",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['MultipleLines', 'InternetService', 'Contract', 'PaymentMethod'], dtype='object')"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data4=data3.select_dtypes(include=\"object\")\n",
    "data4.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "1c230d98-95a4-47fb-a9e2-f06968f9bef8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>MultipleLines_0</th>\n",
       "      <th>MultipleLines_1</th>\n",
       "      <th>MultipleLines_No phone service</th>\n",
       "      <th>InternetService_DSL</th>\n",
       "      <th>InternetService_Fiber optic</th>\n",
       "      <th>InternetService_No</th>\n",
       "      <th>Contract_Month-to-month</th>\n",
       "      <th>Contract_One year</th>\n",
       "      <th>Contract_Two year</th>\n",
       "      <th>PaymentMethod_Bank transfer (automatic)</th>\n",
       "      <th>PaymentMethod_Credit card (automatic)</th>\n",
       "      <th>PaymentMethod_Electronic check</th>\n",
       "      <th>PaymentMethod_Mailed check</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7038</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7039</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7040</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7041</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7042</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>7032 rows × 13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      MultipleLines_0  MultipleLines_1  MultipleLines_No phone service  \\\n",
       "0                   0                0                               1   \n",
       "1                   1                0                               0   \n",
       "2                   1                0                               0   \n",
       "3                   0                0                               1   \n",
       "4                   1                0                               0   \n",
       "...               ...              ...                             ...   \n",
       "7038                0                1                               0   \n",
       "7039                0                1                               0   \n",
       "7040                0                0                               1   \n",
       "7041                0                1                               0   \n",
       "7042                1                0                               0   \n",
       "\n",
       "      InternetService_DSL  InternetService_Fiber optic  InternetService_No  \\\n",
       "0                       1                            0                   0   \n",
       "1                       1                            0                   0   \n",
       "2                       1                            0                   0   \n",
       "3                       1                            0                   0   \n",
       "4                       0                            1                   0   \n",
       "...                   ...                          ...                 ...   \n",
       "7038                    1                            0                   0   \n",
       "7039                    0                            1                   0   \n",
       "7040                    1                            0                   0   \n",
       "7041                    0                            1                   0   \n",
       "7042                    0                            1                   0   \n",
       "\n",
       "      Contract_Month-to-month  Contract_One year  Contract_Two year  \\\n",
       "0                           1                  0                  0   \n",
       "1                           0                  1                  0   \n",
       "2                           1                  0                  0   \n",
       "3                           0                  1                  0   \n",
       "4                           1                  0                  0   \n",
       "...                       ...                ...                ...   \n",
       "7038                        0                  1                  0   \n",
       "7039                        0                  1                  0   \n",
       "7040                        1                  0                  0   \n",
       "7041                        1                  0                  0   \n",
       "7042                        0                  0                  1   \n",
       "\n",
       "      PaymentMethod_Bank transfer (automatic)  \\\n",
       "0                                           0   \n",
       "1                                           0   \n",
       "2                                           0   \n",
       "3                                           1   \n",
       "4                                           0   \n",
       "...                                       ...   \n",
       "7038                                        0   \n",
       "7039                                        0   \n",
       "7040                                        0   \n",
       "7041                                        0   \n",
       "7042                                        1   \n",
       "\n",
       "      PaymentMethod_Credit card (automatic)  PaymentMethod_Electronic check  \\\n",
       "0                                         0                               1   \n",
       "1                                         0                               0   \n",
       "2                                         0                               0   \n",
       "3                                         0                               0   \n",
       "4                                         0                               1   \n",
       "...                                     ...                             ...   \n",
       "7038                                      0                               0   \n",
       "7039                                      1                               0   \n",
       "7040                                      0                               1   \n",
       "7041                                      0                               0   \n",
       "7042                                      0                               0   \n",
       "\n",
       "      PaymentMethod_Mailed check  \n",
       "0                              0  \n",
       "1                              1  \n",
       "2                              1  \n",
       "3                              0  \n",
       "4                              0  \n",
       "...                          ...  \n",
       "7038                           1  \n",
       "7039                           0  \n",
       "7040                           0  \n",
       "7041                           1  \n",
       "7042                           0  \n",
       "\n",
       "[7032 rows x 13 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data5=pd.get_dummies(data4).astype(int)\n",
    "data5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "cb6742dc-56d0-4863-8e11-63b75223726d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['MultipleLines', 'InternetService', 'Contract', 'PaymentMethod'], dtype='object')"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data4.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "6ee7ffd5-f626-4b37-9e4f-764a883b7187",
   "metadata": {},
   "outputs": [],
   "source": [
    "dropped_col=data4.columns\n",
    "data6=pd.concat([data3,data5],axis=\"columns\")\n",
    "data6.drop(dropped_col,axis=1,inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "45dfcb50-4275-4cda-a313-6a729d5f1919",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>SeniorCitizen</th>\n",
       "      <th>Partner</th>\n",
       "      <th>Dependents</th>\n",
       "      <th>tenure</th>\n",
       "      <th>PhoneService</th>\n",
       "      <th>OnlineSecurity</th>\n",
       "      <th>OnlineBackup</th>\n",
       "      <th>DeviceProtection</th>\n",
       "      <th>TechSupport</th>\n",
       "      <th>...</th>\n",
       "      <th>InternetService_DSL</th>\n",
       "      <th>InternetService_Fiber optic</th>\n",
       "      <th>InternetService_No</th>\n",
       "      <th>Contract_Month-to-month</th>\n",
       "      <th>Contract_One year</th>\n",
       "      <th>Contract_Two year</th>\n",
       "      <th>PaymentMethod_Bank transfer (automatic)</th>\n",
       "      <th>PaymentMethod_Credit card (automatic)</th>\n",
       "      <th>PaymentMethod_Electronic check</th>\n",
       "      <th>PaymentMethod_Mailed check</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3199</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>68</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3438</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>18</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3217</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5837</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4 rows × 29 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      gender  SeniorCitizen  Partner  Dependents  tenure  PhoneService  \\\n",
       "3199       0              0        0           0      68             1   \n",
       "3438       1              0        1           0      18             1   \n",
       "3217       0              0        0           0       2             1   \n",
       "5837       0              0        0           0       2             0   \n",
       "\n",
       "      OnlineSecurity  OnlineBackup  DeviceProtection  TechSupport  ...  \\\n",
       "3199               0             0                 0            0  ...   \n",
       "3438               0             0                 0            0  ...   \n",
       "3217               0             0                 0            0  ...   \n",
       "5837               0             1                 0            0  ...   \n",
       "\n",
       "      InternetService_DSL  InternetService_Fiber optic  InternetService_No  \\\n",
       "3199                    0                            0                   1   \n",
       "3438                    0                            1                   0   \n",
       "3217                    0                            0                   1   \n",
       "5837                    1                            0                   0   \n",
       "\n",
       "      Contract_Month-to-month  Contract_One year  Contract_Two year  \\\n",
       "3199                        0                  0                  1   \n",
       "3438                        1                  0                  0   \n",
       "3217                        1                  0                  0   \n",
       "5837                        1                  0                  0   \n",
       "\n",
       "      PaymentMethod_Bank transfer (automatic)  \\\n",
       "3199                                        1   \n",
       "3438                                        0   \n",
       "3217                                        0   \n",
       "5837                                        0   \n",
       "\n",
       "      PaymentMethod_Credit card (automatic)  PaymentMethod_Electronic check  \\\n",
       "3199                                      0                               0   \n",
       "3438                                      0                               1   \n",
       "3217                                      0                               0   \n",
       "5837                                      0                               1   \n",
       "\n",
       "      PaymentMethod_Mailed check  \n",
       "3199                           0  \n",
       "3438                           0  \n",
       "3217                           1  \n",
       "5837                           0  \n",
       "\n",
       "[4 rows x 29 columns]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data6.sample(4)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8597c4f1-2a0b-4d02-9f7c-dd6316843ac6",
   "metadata": {},
   "source": [
    "# implemnting ANN "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "52fc2ea8-4324-4bee-8d74-92be9f11c0d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "import tensorflow as tf\n",
    "from tensorflow import keras\n",
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "29185ffe-9bf1-423b-aab0-a4eb0c060fbe",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(data6.drop(columns=\"Churn\"),data6.Churn,test_size=0.25,random_state=25)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "45862881-8cbd-4edc-acf6-bb16615535ac",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(5274, 28)"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "463d62a9-f804-4d7d-b2f1-fbe0cdd35e65",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(5274,)"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_train.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "ed05e3b7-0178-4fdf-a5b7-b69427d2dd83",
   "metadata": {
    "collapsed": true,
    "jupyter": {
     "outputs_hidden": true
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 2ms/step - accuracy: 0.6046 - loss: 2.0371\n",
      "Epoch 2/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 2ms/step - accuracy: 0.7447 - loss: 0.7060\n",
      "Epoch 3/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 3ms/step - accuracy: 0.7541 - loss: 0.6807\n",
      "Epoch 4/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7313 - loss: 1.4560\n",
      "Epoch 5/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7725 - loss: 0.9543\n",
      "Epoch 6/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7477 - loss: 0.9979\n",
      "Epoch 7/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7652 - loss: 0.8160\n",
      "Epoch 8/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7835 - loss: 0.5298\n",
      "Epoch 9/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7829 - loss: 0.5156\n",
      "Epoch 10/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7748 - loss: 0.6747\n",
      "Epoch 11/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 4ms/step - accuracy: 0.7787 - loss: 0.6535\n",
      "Epoch 12/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7719 - loss: 0.5704\n",
      "Epoch 13/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7661 - loss: 0.6509\n",
      "Epoch 14/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7854 - loss: 0.5253\n",
      "Epoch 15/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7897 - loss: 0.5177\n",
      "Epoch 16/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 4ms/step - accuracy: 0.7643 - loss: 0.7462\n",
      "Epoch 17/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 5ms/step - accuracy: 0.7879 - loss: 0.5809\n",
      "Epoch 18/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7789 - loss: 0.6149\n",
      "Epoch 19/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7652 - loss: 0.6643\n",
      "Epoch 20/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7608 - loss: 0.7715\n",
      "Epoch 21/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 4ms/step - accuracy: 0.7827 - loss: 0.5938\n",
      "Epoch 22/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7753 - loss: 0.7079\n",
      "Epoch 23/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7769 - loss: 0.5677\n",
      "Epoch 24/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7655 - loss: 0.7068\n",
      "Epoch 25/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7632 - loss: 0.6546\n",
      "Epoch 26/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7844 - loss: 0.5057\n",
      "Epoch 27/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 4ms/step - accuracy: 0.7753 - loss: 0.5546\n",
      "Epoch 28/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 4ms/step - accuracy: 0.7894 - loss: 0.5155\n",
      "Epoch 29/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7869 - loss: 0.5298\n",
      "Epoch 30/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7834 - loss: 0.5270\n",
      "Epoch 31/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 4ms/step - accuracy: 0.7754 - loss: 0.5808\n",
      "Epoch 32/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7765 - loss: 0.5551\n",
      "Epoch 33/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7909 - loss: 0.4624\n",
      "Epoch 34/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7783 - loss: 0.5035\n",
      "Epoch 35/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7879 - loss: 0.5058\n",
      "Epoch 36/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 4ms/step - accuracy: 0.7847 - loss: 0.4931\n",
      "Epoch 37/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.8018 - loss: 0.4297\n",
      "Epoch 38/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7752 - loss: 0.5454\n",
      "Epoch 39/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 2ms/step - accuracy: 0.7791 - loss: 0.5587\n",
      "Epoch 40/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7859 - loss: 0.4884\n",
      "Epoch 41/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 4ms/step - accuracy: 0.8028 - loss: 0.4510\n",
      "Epoch 42/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7838 - loss: 0.5251\n",
      "Epoch 43/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7926 - loss: 0.4766\n",
      "Epoch 44/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7907 - loss: 0.5187\n",
      "Epoch 45/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7894 - loss: 0.5126\n",
      "Epoch 46/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7999 - loss: 0.4469\n",
      "Epoch 47/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7951 - loss: 0.4840\n",
      "Epoch 48/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7870 - loss: 0.4647\n",
      "Epoch 49/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7645 - loss: 0.7421\n",
      "Epoch 50/50\n",
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.7890 - loss: 0.4800\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<keras.src.callbacks.history.History at 0x238d3247d40>"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model = keras.Sequential([\n",
    "    keras.layers.Dense(28,input_shape=(28,),activation='relu'),# input layer\n",
    "    keras.layers.Dense(14,activation='relu') ,\n",
    "    keras.layers.Dense(7,activation='relu') ,\n",
    "    keras.layers.Dense(1,activation='sigmoid')# output layers\n",
    "])\n",
    "model.compile(\n",
    "    loss='binary_crossentropy',\n",
    "    optimizer='adam',\n",
    "    metrics=['accuracy']\n",
    ")\n",
    "model.fit(X_train,y_train,epochs=50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "b56cb710-564d-4911-ab2e-9b196cca8621",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1m55/55\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 2ms/step - accuracy: 0.7969 - loss: 0.4168\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[0.4181157946586609, 0.7963594794273376]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.evaluate(X_test,y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "956e8733-5ca7-4f41-a399-d3f389bb8467",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1m165/165\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 2ms/step - accuracy: 0.8068 - loss: 0.4212\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[0.4131986200809479, 0.8103905916213989]"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.evaluate(X_train,y_train)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c93789c5-8d11-47f9-a9d7-3386f80ff759",
   "metadata": {},
   "source": [
    "# PLOTING THE CONFUSSION METRIX ON MY MODEL"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "id": "36162b85-ddb4-47ce-921e-6e66cc812b56",
   "metadata": {
    "collapsed": true,
    "jupyter": {
     "outputs_hidden": true
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1m55/55\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 2ms/step\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([[0.01061203],\n",
       "       [0.01510771],\n",
       "       [0.09502365],\n",
       "       [0.12629157],\n",
       "       [0.4019109 ],\n",
       "       [0.11399785],\n",
       "       [0.35372925],\n",
       "       [0.4869017 ],\n",
       "       [0.43113762],\n",
       "       [0.41509894],\n",
       "       [0.778512  ],\n",
       "       [0.8144653 ],\n",
       "       [0.14269564],\n",
       "       [0.80682933],\n",
       "       [0.29723662],\n",
       "       [0.72217417],\n",
       "       [0.19638233],\n",
       "       [0.03042199],\n",
       "       [0.09647787],\n",
       "       [0.04894246],\n",
       "       [0.5853362 ],\n",
       "       [0.33961675],\n",
       "       [0.50904393],\n",
       "       [0.02302759],\n",
       "       [0.10411715],\n",
       "       [0.02244469],\n",
       "       [0.3580455 ],\n",
       "       [0.18444934],\n",
       "       [0.44117758],\n",
       "       [0.00517159],\n",
       "       [0.01329222],\n",
       "       [0.14855538],\n",
       "       [0.09087227],\n",
       "       [0.01405069],\n",
       "       [0.48697904],\n",
       "       [0.28980514],\n",
       "       [0.53276634],\n",
       "       [0.73313195],\n",
       "       [0.38620904],\n",
       "       [0.05643454],\n",
       "       [0.06441911],\n",
       "       [0.5350072 ],\n",
       "       [0.02660981],\n",
       "       [0.02232906],\n",
       "       [0.01819827],\n",
       "       [0.01206941],\n",
       "       [0.01258456],\n",
       "       [0.5856403 ],\n",
       "       [0.50021297],\n",
       "       [0.02180454],\n",
       "       [0.0131796 ],\n",
       "       [0.17780425],\n",
       "       [0.5096331 ],\n",
       "       [0.06945325],\n",
       "       [0.86209023],\n",
       "       [0.01009033],\n",
       "       [0.6154554 ],\n",
       "       [0.5447246 ],\n",
       "       [0.00827425],\n",
       "       [0.45684233],\n",
       "       [0.15033422],\n",
       "       [0.17180742],\n",
       "       [0.54602844],\n",
       "       [0.01616817],\n",
       "       [0.3324334 ],\n",
       "       [0.78735554],\n",
       "       [0.04024374],\n",
       "       [0.18787266],\n",
       "       [0.51931214],\n",
       "       [0.6853749 ],\n",
       "       [0.68119335],\n",
       "       [0.5312344 ],\n",
       "       [0.14726697],\n",
       "       [0.01100854],\n",
       "       [0.08245093],\n",
       "       [0.34480017],\n",
       "       [0.3977605 ],\n",
       "       [0.20403649],\n",
       "       [0.3900168 ],\n",
       "       [0.12108701],\n",
       "       [0.1713967 ],\n",
       "       [0.5556475 ],\n",
       "       [0.03628553],\n",
       "       [0.02371287],\n",
       "       [0.12485486],\n",
       "       [0.01128847],\n",
       "       [0.1409196 ],\n",
       "       [0.16614515],\n",
       "       [0.00876747],\n",
       "       [0.02282299],\n",
       "       [0.58723253],\n",
       "       [0.78433704],\n",
       "       [0.8446802 ],\n",
       "       [0.02685271],\n",
       "       [0.23642793],\n",
       "       [0.2459828 ],\n",
       "       [0.7669938 ],\n",
       "       [0.65430677],\n",
       "       [0.00817181],\n",
       "       [0.5005504 ]], dtype=float32)"
      ]
     },
     "execution_count": 99,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_predicted = model.predict(X_test)\n",
    "y_predicted[:100]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "id": "b20b75b7-a43d-4181-afe8-e17c468261ff",
   "metadata": {},
   "outputs": [],
   "source": [
    "ytest=y_test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "id": "96a8b751-4f5b-46fb-81e4-defd4821a70f",
   "metadata": {
    "collapsed": true,
    "jupyter": {
     "outputs_hidden": true
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 1,\n",
       " 0,\n",
       " 1,\n",
       " 0,\n",
       " 1,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 0,\n",
       " 1,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 1,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 1,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 0,\n",
       " 1,\n",
       " 0,\n",
       " 1,\n",
       " 1,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 1,\n",
       " 1,\n",
       " 1,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 1,\n",
       " 1,\n",
       " 0,\n",
       " 0,\n",
       " 0,\n",
       " 1,\n",
       " 1,\n",
       " 0,\n",
       " 1]"
      ]
     },
     "execution_count": 109,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ypredicted = []\n",
    "for elements in y_predicted :\n",
    "    if elements >= 0.5:\n",
    "        ypredicted.append(1)\n",
    "    else :\n",
    "        ypredicted.append(0)   \n",
    "ypredicted[:100]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "id": "b450a34d-d232-4e42-a338-9e8b95e1a386",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(100,)"
      ]
     },
     "execution_count": 129,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ytest.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 139,
   "id": "d9b30a3b-7802-4620-9f6d-213277a069aa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "100"
      ]
     },
     "execution_count": 139,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ypred = ypredicted[:100]\n",
    "len(ypred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "id": "c0e6b979-b566-4145-add3-af33d80939a2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.86      0.84      0.85        74\n",
      "           1       0.57      0.62      0.59        26\n",
      "\n",
      "    accuracy                           0.78       100\n",
      "   macro avg       0.72      0.73      0.72       100\n",
      "weighted avg       0.79      0.78      0.78       100\n",
      "\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import classification_report,confusion_matrix\n",
    "c_report = classification_report(ytest,ypredicted[:100])\n",
    "print(c_report)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 141,
   "id": "e02a84c8-65d4-4a38-918f-8cc7c0e9c2c9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(95.72222222222221, 0.5, 'Truth')"
      ]
     },
     "execution_count": 141,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAwgAAAJaCAYAAACLNGBfAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8fJSN1AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAvM0lEQVR4nO3dfZyVdZ038M8xcAREFJUZMBVUymclbBFSQQuK7Ym8d9OwwtSSqJTIcFkrqS1GrRAT5VZLRcvbunN13U1NehB1iRVN09D1EZ/KEU0CJHdA5tx/zHTuawJ0RuGcAd5vX9frxVzXdc71lVfx4uvn+v5+pXK5XA4AAECSbWpdAAAA0HVoEAAAgAoNAgAAUKFBAAAAKjQIAABAhQYBAACo0CAAAAAVGgQAAKBCgwAAAFR0q3UBm8KaF5+odQkAG9UuA0fXugSAjWr5y4/XuoQNqubfJbvvslfVntVREgQAAKBii0wQAADgDWtZW+sKakqCAAAAVEgQAACgqNxS6wpqSoIAAABUSBAAAKCoRYIAAACQRIIAAADtlM0gAAAAtJIgAABAkRkEAACAVhIEAAAoMoMAAADQSoIAAABFLWtrXUFNSRAAAIAKDQIAAGwm/vCHP+TjH/94dt555/Ts2TOHHnpo7rnnnsr1crmc6dOnZ8CAAenRo0dGjRqVxYsXd+oZGgQAACgqt1Tv6IRly5blXe96V7p3756bb745Dz74YL773e9mxx13rNxz3nnnZebMmZk9e3YWLVqUhoaGjB49OitXruzwc0rlcrncqco2A2tefKLWJQBsVLsMHF3rEgA2quUvP17rEjZo9ZN3V+1Z2w48rMP3/tM//VP+8z//M3fcccd6r5fL5QwYMCCTJ0/OmWeemSRpbm5OfX19zj333Jx66qkdeo4EAQAAilpaqnY0NzdnxYoV7Y7m5ub1lnXjjTfmsMMOyz/+4z+mX79+GTJkSC677LLK9SVLlqSpqSljxoypnKurq8vIkSOzYMGCDv/raxAAAKBGGhsb06dPn3ZHY2Pjeu994oknMmfOnAwePDg///nPM3HixJx22mm56qqrkiRNTU1Jkvr6+nafq6+vr1zrCMucAgBAQbmKG6VNmzYtU6ZMaXeurq5uvfe2tLTksMMOy4wZM5IkQ4YMyeLFizNnzpx88pOfrNxXKpXafa5cLq9z7rVIEAAAoEbq6uqyww47tDs21CD0798/+++/f7tz++23X55++ukkSUNDQ5KskxYsXbp0nVThtWgQAACgqIozCJ3xrne9Kw8//HC7c4888kj23HPPJMmgQYPS0NCQefPmVa6vXr068+fPz4gRIzr8HK8YAQDAZuCLX/xiRowYkRkzZuSjH/1o7rrrrlx66aW59NJLk7S+WjR58uTMmDEjgwcPzuDBgzNjxoz07Nkz48eP7/BzNAgAAFBUxRmEznjnO9+Z66+/PtOmTcs3vvGNDBo0KLNmzcoJJ5xQuWfq1Kl55ZVXMmnSpCxbtizDhg3Lrbfemt69e3f4OfZBANgM2AcB2NJ05X0Qmh+5s2rPqnvbEVV7VkdJEAAAoKhlba0rqClDygAAQIUEAQAAirroDEK1SBAAAIAKCQIAABR1cn+CLY0EAQAAqJAgAABAkRkEAACAVhoEAACgwitGAABQZEgZAACglQQBAAAKyuW1tS6hpiQIAABAhQQBAACKLHMKAADQSoIAAABFVjECAABoJUEAAIAiMwgAAACtJAgAAFDUYh8EAACAJBIEAABozwwCAABAKwkCAAAU2QcBAACglQQBAACKzCAAAAC0kiAAAECRGQQAAIBWGgQAAKDCK0YAAFDkFSMAAIBWEgQAACgol9fWuoSakiAAAAAVEgQAACgygwAAANBKggAAAEVlCQIAAEASCQIAALRnBgEAAKCVBAEAAIrMIAAAALSSIAAAQJEZBAAAgFYSBAAAKDKDAAAA0EqCAAAARWYQAAAAWmkQAACACq8YAQBAkVeMAAAAWkkQAACgyDKnAAAArSQIAABQZAYBAACglQQBAACKzCAAAAC0kiAAAECRGQQAAIBWEgQAACgygwAAANBKggAAAEVmEAAAAFpJEAAAoEiCAAAA0EqCAAAAReVyrSuoKQkCAABQIUEAAIAiMwgAAACtNAgAAECFV4wAAKDIK0YAAACtJAgAAFBUliAAAAAkkSAAAEB7ZhAAAABaSRAAAKCoXK51BTUlQQAAACokCAAAUGQGAQAAoJUEAQAAiiQIAAAArSQIAABQZCdlAACAVhIEAAAoKLfYBwEAACCJBAEAANqzihEAAEArDQIAAFDhFSMAACiyzCkAAEArCQIAABRZ5hQAAKCVBgEAAIpaWqp3dML06dNTKpXaHQ0NDZXr5XI506dPz4ABA9KjR4+MGjUqixcv7vS/vgYBAAA2EwcccECee+65yvHAAw9Urp133nmZOXNmZs+enUWLFqWhoSGjR4/OypUrO/UMMwgAAFDUhTdK69atW7vU4K/K5XJmzZqVs846K8cee2ySZO7cuamvr88111yTU089tcPPkCAAAECNNDc3Z8WKFe2O5ubmDd7/6KOPZsCAARk0aFCOP/74PPHEE0mSJUuWpKmpKWPGjKncW1dXl5EjR2bBggWdqkmDAAAAReVy1Y7Gxsb06dOn3dHY2LjesoYNG5arrroqP//5z3PZZZelqakpI0aMyJ/+9Kc0NTUlSerr69t9pr6+vnKto7xiBAAANTJt2rRMmTKl3bm6urr13jt27NjKrw866KAMHz48e++9d+bOnZvDDz88SVIqldp9plwur3Pu9WgQAACgqIozCHV1dRtsCF5Pr169ctBBB+XRRx/NuHHjkiRNTU3p379/5Z6lS5eukyq8Hq8YAQDAZqi5uTkPPfRQ+vfvn0GDBqWhoSHz5s2rXF+9enXmz5+fESNGdOp7JQgAAFDURXdSPuOMM/LBD34we+yxR5YuXZpvfvObWbFiRSZMmJBSqZTJkydnxowZGTx4cAYPHpwZM2akZ8+eGT9+fKeeo0GA1/H8Cy9m5sWX586Fd6e5eXX23H23fGPa5Byw7+CsefXVXHjp3Nzxm7vz7B+fy/a9euXwdw7JFyd+Kv123bnWpQOs14h3vTOnnf7pHDrkwPTvX5/xx0/Mz/6j9b86duvWLV/92pSMfu+oDBy4e1asWJnbfr0g0792Xpqalta4cti6Pfvss/nYxz6WF198MbvuumsOP/zwLFy4MHvuuWeSZOrUqXnllVcyadKkLFu2LMOGDcutt96a3r17d+o5pXK53DVbpDdhzYtP1LoEthDLV6zMP37q8/m7dxyS4z7y/vTdacc884c/ZkBDffZ464CsfHlVvnjWt/IPH3pf3r7PXlmxcmXOveCSvLq2JT+5/Hu1Lp8tyC4DR9e6BLYg7xk9MocPH5rf3ff7/PCaOe0ahB122D5X/fCizL3yx3nggYey4459cs65X0m3bt0y6qhxtS2cLcrylx+vdQkb9Jdvn1S1Z/X88uVVe1ZHaRDgNZw/5/Lce/+DuWrOdzr8mQceejgfO2Vy5l03N/0b+m3C6tiaaBDYVJa//Hi7BmF93vGOg/Lr22/IAfsekWeffa6K1bEl0yC06ooNQk1fMXr22WczZ86cLFiwIE1NTSmVSqmvr8+IESMyceLE7L777rUsD/LrOxfmXX83NFO+8q3cfe8D6bfrzjn+2A/kHz40doOfefnlv6RUKqV3715VrBRg09lhh95paWnJ8uUra10KVEcXnUGolpo1CHfeeWfGjh2b3XffPWPGjMmYMWNSLpezdOnS3HDDDbnwwgtz8803513vetdrfk9zc/M6u81t09z8hpeLgqJn/9iUH9/ws3zyuGPz6U8elwcefCSN5//vdO/ePR8e+5517m9uXp3z51yRvx89Ktv30iAAm7+6um0z/RtT839/cmNWrny51uUAVVCzBuGLX/xiTjnllJx//vkbvD558uQsWrToNb+nsbExX//619ud+8qXT8vXpp6+0Wpl69XSUs4B+w7O5IknJkn2e9s+eWzJU/nJ9T9bp0FY8+qr+fLZ56RcbslXz/hcDaoF2Li6deuWy6/8XrbZppQvffHsWpcDVVOu4j4IXVHN9kH4/e9/n4kTJ27w+qmnnprf//73r/s906ZNy/Lly9sdZ56+4e+Fzth1577Ze+Ae7c7tNXD3PPf8C+3OrXn11XzpqzPy7HNNuWzWDOkBsNnr1q1brrz6wuw58K358IcmSA9gK1KzBKF///5ZsGBB3v72t6/3+m9+85t2u8BtyPp2n1uz+sWNUiMMOXj/PPn0s+3OPfX0H9oNH/+1OXj6mT/m8gvPyY59dqh2mQAb1V+bg733HpgP/P0JWfbSn2tdElBFNWsQzjjjjEycODH33HNPRo8enfr6+pRKpTQ1NWXevHn5/ve/n1mzZtWqPEiSfOK4cfnEqV/KpXOvzfvefVQeePDh/PTGm3P21NOSJK++ujZTzvpWHnzksVx03tfT0tKSF//0UpKkzw69071791qWD7BevXr1zF577Vn5ec8935qDDtovy5b9Oc89tzRX/XB2Djn0wBz3D6fkLdtsk379dkmSLFu2PGvWrKlV2VA9W/mQck2XOf3xj3+c888/P/fcc0/Wrl2bJHnLW96SoUOHZsqUKfnoRz/6hr7XMqdsTLf953/lgv99ZZ569g/ZrX9DJhz/kcoqRn947vm89x9OXO/nLr/w3PzdOw6uYqVsySxzysZ0xJHD8rObr1nn/I9+eF3OmXFBHnjw9vV+7v1jx+fOO/5rU5fHVqIrL3O66lufrNqzep11VdWe1VFdYh+ENWvW5MUXW18L2mWXXd70f3XVIABbGg0CsKXp0g3CNz9etWf1+soPq/asjqrpPgh/1b179w7NGwAAAJtWl2gQAACgy9jKZxBqtswpAADQ9UgQAACgyEZpAAAArSQIAABQZAYBAACglQQBAACKymYQAAAAkkgQAACgPTMIAAAArSQIAABQULYPAgAAQCsJAgAAFJlBAAAAaKVBAAAAKrxiBAAARV4xAgAAaCVBAACAorJlTgEAAJJIEAAAoD0zCAAAAK0kCAAAUFCWIAAAALSSIAAAQJEEAQAAoJUEAQAAilrsgwAAAJBEggAAAO2ZQQAAAGglQQAAgCIJAgAAQCsJAgAAFJTLEgQAAIAkEgQAAGjPDAIAAEArDQIAAFDhFSMAACjyihEAAEArCQIAABSUJQgAAACtJAgAAFAkQQAAAGglQQAAgKKWWhdQWxIEAACgQoIAAAAFVjECAABoI0EAAIAiCQIAAEArCQIAABRZxQgAAKCVBAEAAAqsYgQAANBGggAAAEVmEAAAAFppEAAAgAqvGAEAQIEhZQAAgDYSBAAAKDKkDAAA0EqCAAAABWUJAgAAQCsJAgAAFEkQAAAAWkkQAACgwAwCAABAGwkCAAAUSRAAAABaSRAAAKDADAIAAEAbCQIAABRIEAAAANpIEAAAoECCAAAA0EaCAAAAReVSrSuoKQkCAABQoUEAAAAqvGIEAAAFhpQBAADaSBAAAKCg3GJIGQAAIIkEAQAA2jGDAAAA0EaCAAAABWUbpQEAAJuTxsbGlEqlTJ48uXKuXC5n+vTpGTBgQHr06JFRo0Zl8eLFnf5uDQIAABSUW6p3vBGLFi3KpZdemoMPPrjd+fPOOy8zZ87M7Nmzs2jRojQ0NGT06NFZuXJlp75fgwAAAJuJl19+OSeccEIuu+yy7LTTTpXz5XI5s2bNyllnnZVjjz02Bx54YObOnZu//OUvueaaazr1DA0CAAAUlFtKVTuam5uzYsWKdkdzc/MGa/vc5z6X97///XnPe97T7vySJUvS1NSUMWPGVM7V1dVl5MiRWbBgQaf+/TUIAABQI42NjenTp0+7o7Gxcb33Xnvttfntb3+73utNTU1Jkvr6+nbn6+vrK9c6yipGAABQUC5X71nTpk3LlClT2p2rq6tb575nnnkmp59+em699dZst912G/y+Uqn9Ckzlcnmdc69HgwAAADVSV1e33obgb91zzz1ZunRphg4dWjm3du3a3H777Zk9e3YefvjhJK1JQv/+/Sv3LF26dJ1U4fVoEAAAoKDc0vX2QXj3u9+dBx54oN25T33qU9l3331z5plnZq+99kpDQ0PmzZuXIUOGJElWr16d+fPn59xzz+3UszQIAADQxfXu3TsHHnhgu3O9evXKzjvvXDk/efLkzJgxI4MHD87gwYMzY8aM9OzZM+PHj+/UszQIAABQ0BUThI6YOnVqXnnllUyaNCnLli3LsGHDcuutt6Z3796d+p5SuVzNMYzqWPPiE7UuAWCj2mXg6FqXALBRLX/58VqXsEFPHlq9P3MH3jevas/qKMucAgAAFV4xAgCAgi3v/ZrOkSAAAAAVEgQAACjYXIeUNxYJAgAAUCFBAACAgnJZggAAAJBEggAAAO2UW2pdQW1JEAAAgAoJAgAAFLSYQQAAAGglQQAAgAKrGAEAALSRIAAAQIGdlAEAANpIEAAAoKBcrnUFtSVBAAAAKiQIAABQsLXPILyhBqGlpSWPPfZYli5dmpaW9ntRH3XUURulMAAAoPo63SAsXLgw48ePz1NPPZXy37ygVSqVsnbt2o1WHAAAVNvWvpNypxuEiRMn5rDDDsvPfvaz9O/fP6XS1v0bCAAAW5JONwiPPvpofvrTn2afffbZFPUAAAA11OlVjIYNG5bHHntsU9QCAAA1Vy6XqnZ0RR1KEO6///7Kr7/whS/kS1/6UpqamnLQQQele/fu7e49+OCDN26FAABA1XSoQTj00ENTKpXaDSWfdNJJlV//9ZohZQAANndb+0ZpHWoQlixZsqnrAAAAuoAONQh77rln5de33357RowYkW7d2n/01VdfzYIFC9rdCwAAm5utfZnTTg8pH3300XnppZfWOb98+fIcffTRG6UoAACgNjq9zOlfZw3+1p/+9Kf06tVroxQFAAC10lVXF6qWDjcIxx57bJLWgeQTTzwxdXV1lWtr167N/fffnxEjRmz8CgEAgKrpcIPQp0+fJK0JQu/evdOjR4/KtW233TaHH354Pv3pT2/8CgEAoIqsYtRBV1xxRZJk4MCBOeOMM7xOBAAAW6BOzyCcffbZm6IOAADoErb2VYw63SAMGjRovUPKf/XEE0+8qYIAAIDa6XSDMHny5HY/r1mzJvfee29uueWWfPnLX95Ydb0pPQYcWesSADaqfXfavdYlAGw1rGLUSaeffvp6z1900UW5++6733RBAABA7XR6o7QNGTt2bK677rqN9XUAAFATLeVS1Y6uaKM1CD/96U/Tt2/fjfV1AABADXT6FaMhQ4a0G1Iul8tpamrKCy+8kIsvvnijFgcAANW2lW+D0PkGYdy4ce1+3mabbbLrrrtm1KhR2XfffTdWXQAAQA10qkF49dVXM3DgwLz3ve9NQ0PDpqoJAACokU41CN26dctnP/vZPPTQQ5uqHgAAqKmuOjxcLZ0eUh42bFjuvffeTVELAABQY52eQZg0aVK+9KUv5dlnn83QoUPTq1evdtcPPvjgjVYcAABUm43SOuikk07KrFmzctxxxyVJTjvttMq1UqmUcrmcUqmUtWvXbvwqAQCAquhwgzB37tycc845WbJkyaasBwAAaqql1gXUWIcbhHK5dUXYPffcc5MVAwAA1FanZhCKG6QBAMCWqJyt+++8nWoQ3va2t71uk/DSSy+9qYIAAIDa6VSD8PWvfz19+vTZVLUAAEDNtZRrXUFtdapBOP7449OvX79NVQsAAFBjHW4QzB8AALA1aNnKZxA6vJPyX1cxAgAAtlwdThBaWrb2FWEBANgabO2rGHU4QQAAALZ8nRpSBgCALd3W/t6MBAEAAKiQIAAAQIEZBAAAgDYSBAAAKDCDAAAA0EaDAAAAVHjFCAAACrxiBAAA0EaCAAAABZY5BQAAaCNBAACAgpatO0CQIAAAAP+fBAEAAApazCAAAAC0kiAAAEBBudYF1JgEAQAAqJAgAABAgZ2UAQAA2kgQAACgoKVkFSMAAIAkEgQAAGjHKkYAAABtJAgAAFBgFSMAAIA2GgQAAKDCK0YAAFDQsnWvcipBAAAA/j8JAgAAFLRk644QJAgAAECFBAEAAApslAYAANBGggAAAAVWMQIAAGgjQQAAgIKWWhdQYxIEAACgQoIAAAAFVjECAAC6vDlz5uTggw/ODjvskB122CHDhw/PzTffXLleLpczffr0DBgwID169MioUaOyePHiTj9HgwAAAAUtpeodnfHWt74155xzTu6+++7cfffdOeaYY/LhD3+40gScd955mTlzZmbPnp1FixaloaEho0ePzsqVKzv1nFK5XN7iUpRu2+5W6xIANqp9d9q91iUAbFS/f35hrUvYoB+89eNVe9bJz/7wTX2+b9+++fa3v52TTjopAwYMyOTJk3PmmWcmSZqbm1NfX59zzz03p556aoe/U4IAAAAFLVU8mpubs2LFinZHc3Pz69a4du3aXHvttVm1alWGDx+eJUuWpKmpKWPGjKncU1dXl5EjR2bBggWd+vfXIAAAQI00NjamT58+7Y7GxsYN3v/AAw9k++23T11dXSZOnJjrr78++++/f5qampIk9fX17e6vr6+vXOsoqxgBAEBBNfdBmDZtWqZMmdLuXF1d3Qbvf/vb35777rsvf/7zn3PddddlwoQJmT9/fuV6qdR+sKFcLq9z7vVoEAAAoEbq6upesyH4W9tuu2322WefJMlhhx2WRYsW5YILLqjMHTQ1NaV///6V+5cuXbpOqvB6vGIEAAAF5VL1jjdda7mc5ubmDBo0KA0NDZk3b17l2urVqzN//vyMGDGiU98pQQAAgM3AP//zP2fs2LHZfffds3Llylx77bW57bbbcsstt6RUKmXy5MmZMWNGBg8enMGDB2fGjBnp2bNnxo8f36nnaBAAAGAz8Pzzz+cTn/hEnnvuufTp0ycHH3xwbrnllowePTpJMnXq1LzyyiuZNGlSli1blmHDhuXWW29N7969O/Uc+yAAbAbsgwBsabryPggX7169fRAmPfPm9kHYFMwgAAAAFV4xAgCAgmouc9oVSRAAAIAKCQIAABRscQO6nSRBAAAAKiQIAABQ0LIRNjDbnEkQAACACgkCAAAUWMUIAACgjQQBAAAKJAgAAABtJAgAAFBgHwQAAIA2EgQAACiwDwIAAEAbCQIAABRYxQgAAKCNBgEAAKjwihEAABRY5hQAAKCNBAEAAApatvIMQYIAAABUSBAAAKDAMqcAAABtJAgAAFCwdU8gSBAAAIACCQIAABSYQQAAAGgjQQAAgIKWUq0rqC0JAgAAUCFBAACAAjspAwAAtJEgAABAwdadH0gQAACAAgkCAAAU2AcBAACgjQQBAAAKrGIEAADQRoMAAABUeMUIAAAKtu4XjCQIAABAgQQBAAAKLHMKAADQRoIAAAAFljkFAABoI0EAAICCrTs/kCAAAAAFEgQAACiwihEAAEAbCQIAABSUt/IpBAkCAABQIUEAAIACMwgAAABtJAgAAFBgJ2UAAIA2EgQAACjYuvMDCQIAAFCgQQAAACq8YgQAAAWGlAEAANpoEOB1HHnEsNxw/ZV5+sl78urqP+RDH3rvOvd87atT8vST92Tl8sfyy3n/N/vv/7YaVArQMUMPPzSzr/5OfvW7f8/vn1+YY8Yetc49ew0emAuv+nZ+8+gv8l+P/zI/uun7aditvgbVQvW1VPHoijQI8Dp69eqZ++9/MKdN/sp6r3/5jEmZfPpnctrkr+TwEe9P0/Mv5Jab/k+2375XlSsF6JgePXvk4cWPZsa07673+u577parbrwkSx59Kp/6yKT8r2M+kUtmXp7VzaurXClQC2YQ4HXc8vNf55af/3qD10/7wilpPOd7ueGGm5Mknzppcv747H352PEfyWXf/2G1ygTosDt/9Zvc+avfbPD6af88MXf8ckFm/svsyrlnn/pjNUqDLqFsBgF4owYN2iP9+9dn3i/mV86tXr06t9+xMMOHH1bDygDemFKplKPeMyJPPv50Lrl2VuYvvinX3PyD9b6GBGyZNAjwJjTU90uSPP/8i+3OP//8C2mo37UWJQG8KX132Sm9tu+Vk0/7ZO789cJ85qOn55c33ZZZl5+Tw4YPqXV5UBVmELqwZ555JieddNJr3tPc3JwVK1a0O8rlrTsWovr+9n9zpVLJ/w6BzdI227T+1eDXt9yeqy+5Ng8vfjQ/uPDqzJ/3n/nohI/UuDqgGrp0g/DSSy9l7ty5r3lPY2Nj+vTp0+4ot6ysUoVs7ZqeX5okaWhonxb067dLnl/64vo+AtClLXvpz1mz5tU8/siT7c4/8ciT6b9bQ22KgiorV/GfrqimQ8o33njja15/4oknXvc7pk2blilTprQ7t9PO+76puqCjlix5Os8993ze8+6jct99i5Mk3bt3z1FHHp5p/zyjxtUBdN6ra17N4vsezKC992h3fuDeu+ePzz5Xo6qAaqppgzBu3LjXfRWjVCq95nfU1dWlrq6uU5+BzujVq2f22WdQ5edBA/fIIYcckJdeWpZnnvljvnfh9/NPZ34hjz62JI89tiT/dOYX8pe/vJL/c+31NawaYMN69OyRPQa9tfLzbnsMyNsPGJzlf16Rpj88nysu+lG+c+k3c/fC+3LXnffkiGMOz8gxR+RTH/lcDauG6umqswHVUirX8EXp3XbbLRdddFHGjRu33uv33Xdfhg4dmrVr13bqe7ttu9tGqA5ajTxqeH75i5+uc37uVT/Jyad8MUnrRmmfPuXj2WmnPrnrrnvzhdPPyuLFD1e7VLZg++60e61LYAvyzhHvyBXXX7zO+Ruu/Vm+cvq/JEk+8rEP5JTTJqS+/6558vGnc9G3L8uvb7mj2qWyBfv98wtrXcIGTRj4v6r2rLlPXle1Z3VUTRuED33oQzn00EPzjW98Y73Xf/e732XIkCFpaelcH6dBALY0GgRgS9OVG4RP7Hls1Z519VP/WrVndVRNXzH68pe/nFWrVm3w+j777JNf/3rDG1QBAAAbV00bhCOPPPI1r/fq1SsjR46sUjUAAJAuurZQ9XTpZU4BAIDqqmmCAAAAXU3LVp4hSBAAAIAKCQIAABR01R2Oq0WCAAAAVGgQAACACq8YAQBAQee26N3ySBAAAIAKCQIAABRY5hQAAKCNBAEAAAoscwoAANBGggAAAAVWMQIAAGgjQQAAgIJy2QwCAABAEgkCAAC0Yx8EAACANhIEAAAosIoRAABAGw0CAAAUlKv4T2c0Njbmne98Z3r37p1+/fpl3Lhxefjhh9vXXi5n+vTpGTBgQHr06JFRo0Zl8eLFnXqOBgEAADYD8+fPz+c+97ksXLgw8+bNy6uvvpoxY8Zk1apVlXvOO++8zJw5M7Nnz86iRYvS0NCQ0aNHZ+XKlR1+Tqm8BS702m3b3WpdAsBGte9Ou9e6BICN6vfPL6x1CRv093v8fdWeddPTN73hz77wwgvp169f5s+fn6OOOirlcjkDBgzI5MmTc+aZZyZJmpubU19fn3PPPTennnpqh75XggAAADXS3NycFStWtDuam5s79Nnly5cnSfr27ZskWbJkSZqamjJmzJjKPXV1dRk5cmQWLFjQ4Zo0CAAAUCONjY3p06dPu6OxsfF1P1culzNlypQcccQROfDAA5MkTU1NSZL6+vp299bX11eudYRlTgEAoKCab+BPmzYtU6ZMaXeurq7udT/3+c9/Pvfff3/uvPPOda6VSqV2P5fL5XXOvRYNAgAA1EhdXV2HGoKiL3zhC7nxxhtz++23561vfWvlfENDQ5LWJKF///6V80uXLl0nVXgtXjECAICClioenVEul/P5z38+//qv/5pf/epXGTRoULvrgwYNSkNDQ+bNm1c5t3r16syfPz8jRozo8HMkCAAAsBn43Oc+l2uuuSb/9m//lt69e1fmCvr06ZMePXqkVCpl8uTJmTFjRgYPHpzBgwdnxowZ6dmzZ8aPH9/h52gQAACgoLMbmFXLnDlzkiSjRo1qd/6KK67IiSeemCSZOnVqXnnllUyaNCnLli3LsGHDcuutt6Z3794dfo59EAA2A/ZBALY0XXkfhDG7v69qz7r1mVuq9qyOkiAAAEBBSxdNEKrFkDIAAFAhQQAAgIIt8A38TpEgAAAAFRIEAAAoMIMAAADQRoIAAAAFXXUfhGqRIAAAABUSBAAAKGixihEAAEArCQIAABRs3fmBBAEAACjQIAAAABVeMQIAgAIbpQEAALSRIAAAQIEEAQAAoI0EAQAACso2SgMAAGglQQAAgAIzCAAAAG0kCAAAUFCWIAAAALSSIAAAQIFVjAAAANpIEAAAoMAqRgAAAG0kCAAAUGAGAQAAoI0EAQAACswgAAAAtJEgAABAgZ2UAQAA2mgQAACACq8YAQBAQYtlTgEAAFpJEAAAoMCQMgAAQBsJAgAAFJhBAAAAaCNBAACAAjMIAAAAbSQIAABQYAYBAACgjQQBAAAKzCAAAAC0kSAAAECBGQQAAIA2EgQAACgwgwAAANBGggAAAAXlckutS6gpCQIAAFChQQAAACq8YgQAAAUthpQBAABaSRAAAKCgbKM0AACAVhIEAAAoMIMAAADQRoIAAAAFZhAAAADaSBAAAKCgRYIAAADQSoIAAAAFZasYAQAAtJIgAABAgVWMAAAA2kgQAACgwE7KAAAAbSQIAABQYAYBAACgjQQBAAAK7KQMAADQRoMAAABUeMUIAAAKDCkDAAC0kSAAAECBjdIAAADaSBAAAKDADAIAAEAbCQIAABTYKA0AAKCNBAEAAArKVjECAABoJUEAAIACMwgAAABtJAgAAFBgHwQAAIA2EgQAACiwihEAAEAbCQIAABSYQQAAAGijQQAAgM3A7bffng9+8IMZMGBASqVSbrjhhnbXy+Vypk+fngEDBqRHjx4ZNWpUFi9e3OnnaBAAAKCgXC5X7eiMVatW5ZBDDsns2bPXe/28887LzJkzM3v27CxatCgNDQ0ZPXp0Vq5c2annmEEAAIDNwNixYzN27Nj1XiuXy5k1a1bOOuusHHvssUmSuXPnpr6+Ptdcc01OPfXUDj9HggAAAAXlKh4by5IlS9LU1JQxY8ZUztXV1WXkyJFZsGBBp75LggAAADXS3Nyc5ubmdufq6upSV1fXqe9pampKktTX17c7X19fn6eeeqpT37VFNgivrv5DrUtgK9Dc3JzGxsZMmzat0/8nBuiK/LkGrar5d8np06fn61//ertzZ599dqZPn/6Gvq9UKrX7uVwur3Pudb+jvLUv9Apv0IoVK9KnT58sX748O+ywQ63LAXjT/LkG1fdGE4RSqZTrr78+48aNS5I88cQT2XvvvfPb3/42Q4YMqdz34Q9/ODvuuGPmzp3b4ZrMIAAAQI3U1dVlhx12aHe8kQRv0KBBaWhoyLx58yrnVq9enfnz52fEiBGd+q4t8hUjAADY0rz88st57LHHKj8vWbIk9913X/r27Zs99tgjkydPzowZMzJ48OAMHjw4M2bMSM+ePTN+/PhOPUeDAAAAm4G77747Rx99dOXnKVOmJEkmTJiQK6+8MlOnTs0rr7ySSZMmZdmyZRk2bFhuvfXW9O7du1PPMYMAb5BhPmBL4881INEgAAAABYaUAQCACg0CAABQoUEAAAAqNAgAAECFBgHeoIsvvjiDBg3Kdtttl6FDh+aOO+6odUkAb8jtt9+eD37wgxkwYEBKpVJuuOGGWpcE1JAGAd6AH//4x5k8eXLOOuus3HvvvTnyyCMzduzYPP3007UuDaDTVq1alUMOOSSzZ8+udSlAF2CZU3gDhg0blne84x2ZM2dO5dx+++2XcePGpbGxsYaVAbw5pVIp119/fcaNG1frUoAakSBAJ61evTr33HNPxowZ0+78mDFjsmDBghpVBQCwcWgQoJNefPHFrF27NvX19e3O19fXp6mpqUZVAQBsHBoEeINKpVK7n8vl8jrnAAA2NxoE6KRddtklb3nLW9ZJC5YuXbpOqgAAsLnRIEAnbbvtthk6dGjmzZvX7vy8efMyYsSIGlUFALBxdKt1AbA5mjJlSj7xiU/ksMMOy/Dhw3PppZfm6aefzsSJE2tdGkCnvfzyy3nssccqPy9ZsiT33Xdf+vbtmz322KOGlQG1YJlTeIMuvvjinHfeeXnuuedy4IEH5vzzz89RRx1V67IAOu22227L0Ucfvc75CRMm5Morr6x+QUBNaRAAAIAKMwgAAECFBgEAAKjQIAAAABUaBAAAoEKDAAAAVGgQAACACg0CAABQoUEA6GKmT5+eQw89tPLziSeemHHjxlW9jieffDKlUin33Xdf1Z8NQO1oEAA66MQTT0ypVEqpVEr37t2z11575YwzzsiqVas26XMvuOCCDu9m6y/1ALxZ3WpdAMDm5H3ve1+uuOKKrFmzJnfccUdOOeWUrFq1KnPmzGl335o1a9K9e/eN8sw+ffpslO8BgI6QIAB0Ql1dXRoaGrL77rtn/PjxOeGEE3LDDTdUXgu6/PLLs9dee6Wuri7lcjnLly/PZz7zmfTr1y877LBDjjnmmPzud79r953nnHNO6uvr07t375x88sn5n//5n3bX//YVo5aWlpx77rnZZ599UldXlz322CPf+ta3kiSDBg1KkgwZMiSlUimjRo2qfO6KK67Ifvvtl+222y777rtvLr744nbPueuuuzJkyJBst912Oeyww3LvvfduxN85ADYXEgSAN6FHjx5Zs2ZNkuSxxx7LT37yk1x33XV5y1vekiR5//vfn759++amm25Knz59cskll+Td7353HnnkkfTt2zc/+clPcvbZZ+eiiy7KkUcemauvvjrf+973stdee23wmdOmTctll12W888/P0cccUSee+65/Pd//3eS1r/k/93f/V1+8Ytf5IADDsi2226bJLnsssty9tlnZ/bs2RkyZEjuvffefPrTn06vXr0yYcKErFq1Kh/4wAdyzDHH5Ic//GGWLFmS008/fRP/7gHQFWkQAN6gu+66K9dcc03e/e53J0lWr16dq6++OrvuumuS5Fe/+lUeeOCBLF26NHV1dUmS73znO7nhhhvy05/+NJ/5zGcya9asnHTSSTnllFOSJN/85jfzi1/8Yp0U4a9WrlyZCy64ILNnz86ECROSJHvvvXeOOOKIJKk8e+edd05DQ0Plc//yL/+S7373uzn22GOTtCYNDz74YC655JJMmDAhP/rRj7J27dpcfvnl6dmzZw444IA8++yz+exnP7uxf9sA6OK8YgTQCf/xH/+R7bffPtttt12GDx+eo446KhdeeGGSZM8996z8BT1J7rnnnrz88svZeeeds/3221eOJUuW5PHHH0+SPPTQQxk+fHi7Z/ztz0UPPfRQmpubK01JR7zwwgt55plncvLJJ7er45vf/Ga7Og455JD07NmzQ3UAsOWSIAB0wtFHH505c+ake/fuGTBgQLtB5F69erW7t6WlJf37989tt922zvfsuOOOb+j5PXr06PRnWlpakrS+ZjRs2LB21/76KlS5XH5D9QCw5dEgAHRCr169ss8++3To3ne84x1pampKt27dMnDgwPXes99++2XhwoX55Cc/WTm3cOHCDX7n4MGD06NHj/zyl7+svJZU9NeZg7Vr11bO1dfXZ7fddssTTzyRE044Yb3fu//+++fqq6/OK6+8UmlCXqsOALZcXjEC2ETe8573ZPjw4Rk3blx+/vOf58knn8yCBQvyla98JXfffXeS5PTTT8/ll1+eyy+/PI888kjOPvvsLF68eIPfud122+XMM8/M1KlTc9VVV+Xxxx/PwoUL84Mf/CBJ0q9fv/To0SO33HJLnn/++SxfvjxJ6+ZrjY2NueCCC/LII4/kgQceyBVXXJGZM2cmScaPH59tttkmJ598ch588MHcdNNN+c53vrOJf4cA6Io0CACbSKlUyk033ZSjjjoqJ510Ut72trfl+OOPz5NPPpn6+vokyXHHHZevfe1rOfPMMzN06NA89dRTrzsY/NWvfjVf+tKX8rWvfS377bdfjjvuuCxdujRJ0q1bt3zve9/LJZdckgEDBuTDH/5wkuSUU07J97///Vx55ZU56KCDMnLkyFx55ZWVZVG33377/Pu//3sefPDBDBkyJGeddVbOPffcTfi7A0BXVSp78RQAAGgjQQAAACo0CAAAQIUGAQAAqNAgAAAAFRoEAACgQoMAAABUaBAAAIAKDQIAAFChQQAAACo0CAAAQIUGAQAAqNAgAAAAFf8PmmibeqslzMkAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 1000x700 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import seaborn as sn\n",
    "cm = tf.math.confusion_matrix(labels=ytest,predictions=ypredicted[:100])\n",
    "plt.figure(figsize = (10,7))\n",
    "sn.heatmap(cm, annot=True, fmt='d')\n",
    "plt.xlabel('Predicted')\n",
    "plt.ylabel('Truth')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
